{
  "neighbor_search": {
    "mean_ms": 0.5295682698488235,
    "std_ms": 0.13776582974648896,
    "min_ms": 0.29461830854415894,
    "p50_ms": 0.5069579929113388,
    "p95_ms": 0.7535487413406372,
    "max_ms": 0.7987730205059052,
    "n_atoms": 12,
    "n_edges": 132,
    "edges_per_atom": 11.0
  },
  "rbf_computation": {
    "rbf_only": {
      "mean_ms": 0.1848035678267479,
      "std_ms": 0.08541365206229332,
      "min_ms": 0.10104477405548096,
      "p50_ms": 0.1856442540884018,
      "p95_ms": 0.35909172147512436,
      "max_ms": 0.36326050758361816
    },
    "cutoff_only": {
      "mean_ms": 0.1782577857375145,
      "std_ms": 0.08529196068581277,
      "min_ms": 0.100012868642807,
      "p50_ms": 0.1567266881465912,
      "p95_ms": 0.3611605614423752,
      "max_ms": 0.36706775426864624
    },
    "rbf_cutoff_fused": {
      "mean_ms": 0.32709624618291855,
      "std_ms": 0.10934195075638063,
      "min_ms": 0.21474063396453857,
      "p50_ms": 0.27352385222911835,
      "p95_ms": 0.550910085439682,
      "max_ms": 0.8079856634140015
    },
    "fusion_opportunity": {
      "sequential_time_ms": 0.3630613535642624,
      "fused_time_ms": 0.32709624618291855,
      "overhead_ms": -0.03596510738134384,
      "fusion_benefit_potential": 1.109952675400718
    }
  },
  "edge_features": {
    "edge_vectors": {
      "mean_ms": 0.10691028088331223,
      "std_ms": 0.09668730817244466,
      "min_ms": 0.044092535972595215,
      "p50_ms": 0.047244131565093994,
      "p95_ms": 0.3572273999452591,
      "max_ms": 0.3591105341911316
    },
    "distances": {
      "mean_ms": 0.14023080468177795,
      "std_ms": 0.09543171060701398,
      "min_ms": 0.06591901183128357,
      "p50_ms": 0.07637403905391693,
      "p95_ms": 0.36192256957292557,
      "max_ms": 0.3664568066596985
    },
    "normalization": {
      "mean_ms": 0.1715097576379776,
      "std_ms": 0.08811660173991949,
      "min_ms": 0.09522214531898499,
      "p50_ms": 0.12121722102165222,
      "p95_ms": 0.3663359209895134,
      "max_ms": 0.4665888845920563
    },
    "full_pipeline": {
      "mean_ms": 0.509735681116581,
      "std_ms": 0.13301665956518768,
      "min_ms": 0.3345310688018799,
      "p50_ms": 0.4857946187257767,
      "p95_ms": 0.7884429767727852,
      "max_ms": 0.8078925311565399
    }
  },
  "message_passing": {
    "layer_1": {
      "message": {
        "mean_ms": 0.47532282769680023,
        "std_ms": 0.0764302248524673,
        "min_ms": 0.39295852184295654,
        "p50_ms": 0.44001638889312744,
        "p95_ms": 0.597570464015007,
        "max_ms": 0.6376728415489197
      },
      "update": {
        "mean_ms": 0.4750317335128784,
        "std_ms": 0.0750619774878434,
        "min_ms": 0.39273127913475037,
        "p50_ms": 0.43592602014541626,
        "p95_ms": 0.5887212231755257,
        "max_ms": 0.6079226732254028
      },
      "combined": {
        "mean_ms": 0.8709469437599182,
        "std_ms": 0.07691803488388552,
        "min_ms": 0.7822290062904358,
        "p50_ms": 0.8377879858016968,
        "p95_ms": 1.0182306170463562,
        "max_ms": 1.050502061843872
      }
    },
    "layer_2": {
      "message": {
        "mean_ms": 0.4668167978525162,
        "std_ms": 0.18900286531700705,
        "min_ms": 0.3806203603744507,
        "p50_ms": 0.41913799941539764,
        "p95_ms": 0.6008807569742203,
        "max_ms": 1.713830977678299
      },
      "update": {
        "mean_ms": 0.48491306602954865,
        "std_ms": 0.07224093965886412,
        "min_ms": 0.37588924169540405,
        "p50_ms": 0.45550987124443054,
        "p95_ms": 0.5982860922813416,
        "max_ms": 0.6100572645664215
      },
      "combined": {
        "mean_ms": 0.9707916527986526,
        "std_ms": 0.15482443269711355,
        "min_ms": 0.8186735212802887,
        "p50_ms": 0.9370744228363037,
        "p95_ms": 1.1471077799797058,
        "max_ms": 1.7826035618782043
      }
    },
    "layer_3": {
      "message": {
        "mean_ms": 0.5708616971969604,
        "std_ms": 0.11930250912887584,
        "min_ms": 0.43353065848350525,
        "p50_ms": 0.5082376301288605,
        "p95_ms": 0.7910430431365967,
        "max_ms": 0.7924474775791168
      },
      "update": {
        "mean_ms": 0.5751415342092514,
        "std_ms": 0.12379121875648369,
        "min_ms": 0.39329007267951965,
        "p50_ms": 0.5235858261585236,
        "p95_ms": 0.772622600197792,
        "max_ms": 0.8916221559047699
      },
      "combined": {
        "mean_ms": 0.9325180202722549,
        "std_ms": 0.11567370079318424,
        "min_ms": 0.7785633206367493,
        "p50_ms": 0.9255930781364441,
        "p95_ms": 1.1481808498501778,
        "max_ms": 1.2474320828914642
      }
    }
  },
  "energy_readout": {
    "mean_ms": 0.3048422932624817,
    "std_ms": 0.08595074356928618,
    "min_ms": 0.17531588673591614,
    "p50_ms": 0.2745389938354492,
    "p95_ms": 0.5108481273055077,
    "max_ms": 0.555042177438736
  },
  "autograd_backward": {
    "mean_ms": 10.14838621020317,
    "std_ms": 1.461370863540658,
    "min_ms": 8.416939526796341,
    "p50_ms": 9.779807180166245,
    "p95_ms": 12.471722252666948,
    "max_ms": 15.536997467279434
  },
  "fusion_opportunities": [
    {
      "name": "Fused Message+Update (layer_3)",
      "description": "Fuse message and update for layer_3",
      "current_time_ms": 0.9325180202722549,
      "potential_speedup": 1.2289341401377192,
      "priority": "MEDIUM"
    },
    {
      "name": "Fused RBF + Cutoff",
      "description": "Fuse Gaussian RBF and cosine cutoff into single kernel",
      "current_time_ms": 0.32709624618291855,
      "potential_speedup": 1.109952675400718,
      "priority": "MEDIUM"
    },
    {
      "name": "Fused Message+Update (layer_1)",
      "description": "Fuse message and update for layer_1",
      "current_time_ms": 0.8709469437599182,
      "potential_speedup": 1.0911738861002878,
      "priority": "MEDIUM"
    },
    {
      "name": "Fused Edge Features",
      "description": "Fuse edge vector, distance, normalization into single kernel",
      "current_time_ms": 0.509735681116581,
      "potential_speedup": 0.821309668348131,
      "priority": "MEDIUM"
    }
  ],
  "optimization_strategy": {
    "week_3": [
      {
        "task": "Implement fused RBF + cutoff Triton kernel",
        "expected_speedup": "1.3-1.5x",
        "effort": "1-2 days",
        "priority": "P0"
      },
      {
        "task": "Implement fused edge features kernel",
        "expected_speedup": "1.2-1.3x",
        "effort": "1-2 days",
        "priority": "P1"
      },
      {
        "task": "Test and validate kernel correctness",
        "expected_speedup": "0x (validation)",
        "effort": "1 day",
        "priority": "P0"
      }
    ],
    "week_4": [
      {
        "task": "Implement fused message passing kernel",
        "expected_speedup": "1.2-1.4x",
        "effort": "2-3 days",
        "priority": "P1"
      },
      {
        "task": "Optimize kernel parameters (block size, etc.)",
        "expected_speedup": "1.1-1.2x",
        "effort": "1-2 days",
        "priority": "P2"
      },
      {
        "task": "Integrate with batched force computation",
        "expected_speedup": "1.5-2x (for batches)",
        "effort": "2-3 days",
        "priority": "P1"
      }
    ],
    "expected_speedup": {
      "week_3_target": "1.5-2x",
      "week_4_target": "2-3x cumulative",
      "total_with_phase3a": "5-7x cumulative (including 3.42x from batching)"
    }
  }
}